{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\maali\\\\OneDrive\\\\Desktop\\\\MUSIC\\\\frontend\\\\src\\\\components\\\\CommentOverlay.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport API_URL from '../config';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst overlayStyle = {\n  position: 'fixed',\n  top: 0,\n  left: 0,\n  width: '100vw',\n  height: '100vh',\n  background: 'rgba(0,0,0,0.3)',\n  zIndex: 2000,\n  display: 'flex',\n  justifyContent: 'flex-end'\n};\nconst drawerStyle = {\n  width: 'min(400px, 100vw)',\n  maxWidth: '100vw',\n  height: '100vh',\n  background: '#181818',\n  boxShadow: '-2px 0 16px rgba(0,0,0,0.2)',\n  display: 'flex',\n  flexDirection: 'column',\n  position: 'relative',\n  animation: 'slideInRight 0.2s'\n};\nconst headerStyle = {\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n  padding: '1rem',\n  borderBottom: '1px solid #222',\n  background: '#222'\n};\nconst commentsListStyle = {\n  flex: 1,\n  overflowY: 'auto',\n  padding: '1rem',\n  color: 'white'\n};\nconst inputSectionStyle = {\n  borderTop: '1px solid #222',\n  padding: '1rem',\n  background: '#222',\n  display: 'flex',\n  flexDirection: 'column',\n  gap: '0.5rem'\n};\nconst closeBtnStyle = {\n  background: 'none',\n  border: 'none',\n  color: '#fff',\n  fontSize: '1.5rem',\n  cursor: 'pointer'\n};\nconst replyInputStyle = {\n  width: '100%',\n  minHeight: '40px',\n  borderRadius: '6px',\n  padding: '0.3rem',\n  border: '1px solid #444',\n  background: '#222',\n  color: 'white',\n  marginTop: '0.3rem',\n  marginBottom: '0.3rem'\n};\nfunction CommentOverlay({\n  open,\n  onClose,\n  track\n}) {\n  _s();\n  const drawerRef = useRef();\n  const [comments, setComments] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [newComment, setNewComment] = useState('');\n  const [replyInputs, setReplyInputs] = useState({}); // {commentId: replyText}\n  const [replying, setReplying] = useState({}); // {commentId: bool}\n  const [openReplies, setOpenReplies] = useState({}); // {commentId: true/false}\n  const [showReplyInput, setShowReplyInput] = useState({}); // {commentId: bool}\n  const replyInputRefs = useRef({});\n  const [activeReplyInputId, setActiveReplyInputId] = useState(null); // ID of comment or reply being replied to\n  const [artist, setArtist] = useState(null);\n  const [trackTitle, setTrackTitle] = useState('');\n  const [openDescendants, setOpenDescendants] = useState({}); // {replyId: true/false}\n\n  // Fetch all comments for a track as a hierarchy, and artist/track info\n  const fetchComments = async () => {\n    if (!(track !== null && track !== void 0 && track._id)) return;\n    setLoading(true);\n    try {\n      const res = await axios.get(`${API_URL}/comments/track/${track._id}/comments-hierarchical`);\n      setComments(res.data.comments || []);\n      setArtist(res.data.artist || null);\n      setTrackTitle(res.data.trackTitle || '');\n    } catch {\n      setComments([]);\n      setArtist(null);\n      setTrackTitle('');\n    } finally {\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    if (!open || !(track !== null && track !== void 0 && track._id)) return;\n    fetchComments();\n    setOpenReplies({}); // Hide all replies by default when overlay opens or track changes\n  }, [open, track]);\n\n  // Add a new top-level comment\n  const handleAddComment = async () => {\n    if (!newComment.trim()) return;\n    setLoading(true);\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`${API_URL}/comments/track/${track._id}/add`, {\n        text: newComment.trim()\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setNewComment('');\n      await fetchComments(); // Re-fetch all comments from backend\n    } catch (err) {\n      var _err$response, _err$response$data;\n      alert(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Error adding comment');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Add a reply to a comment or reply (attach to the actual parent)\n  const handleAddReply = async parentId => {\n    var _replyInputs$parentId;\n    const replyText = (_replyInputs$parentId = replyInputs[parentId]) === null || _replyInputs$parentId === void 0 ? void 0 : _replyInputs$parentId.trim();\n    if (!replyText) return;\n    setReplying(r => ({\n      ...r,\n      [parentId]: true\n    }));\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`${API_URL}/comments/comment/${parentId}/reply`, {\n        trackId: track._id,\n        text: replyText\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      setReplyInputs(i => ({\n        ...i,\n        [parentId]: ''\n      }));\n      setActiveReplyInputId(null); // Hide input after reply\n      await fetchComments(); // Refresh comments\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      alert(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || 'Error adding reply');\n    } finally {\n      setReplying(r => ({\n        ...r,\n        [parentId]: false\n      }));\n    }\n  };\n\n  // New: handle reply to a top-level comment (pre-fill @ParentUserName)\n  const handleReplyToComment = (commentId, parentUserName) => {\n    setReplyInputs(inputs => {\n      var _inputs$commentId;\n      return {\n        ...inputs,\n        [commentId]: (_inputs$commentId = inputs[commentId]) !== null && _inputs$commentId !== void 0 && _inputs$commentId.startsWith(`@${parentUserName} `) ? inputs[commentId] : `@${parentUserName} `\n      };\n    });\n    setActiveReplyInputId(currentId => {\n      if (currentId === commentId) return null; // Toggle off if already open\n      setTimeout(() => {\n        const input = replyInputRefs.current[commentId];\n        if (input) {\n          input.focus();\n          const val = input.value;\n          input.setSelectionRange(val.length, val.length);\n        }\n      }, 0);\n      return commentId;\n    });\n  };\n\n  // New: handle reply to a reply (pre-fill @username in the parent comment's reply input)\n  const handleReplyToReply = (parentCommentId, replyId, replyUserName) => {\n    setReplyInputs(inputs => {\n      var _inputs$replyId;\n      return {\n        ...inputs,\n        [replyId]: (_inputs$replyId = inputs[replyId]) !== null && _inputs$replyId !== void 0 && _inputs$replyId.startsWith(`@${replyUserName} `) ? inputs[replyId] : `@${replyUserName} `\n      };\n    });\n    setActiveReplyInputId(currentId => {\n      if (currentId === replyId) return null; // Toggle off if already open\n      setTimeout(() => {\n        const input = replyInputRefs.current[replyId];\n        if (input) {\n          input.focus();\n          const val = input.value;\n          input.setSelectionRange(val.length, val.length);\n        }\n      }, 0);\n      return replyId;\n    });\n  };\n\n  // Toggle replies for a comment\n  const handleToggleReplies = async commentId => {\n    setOpenReplies(prev => ({\n      ...prev,\n      [commentId]: !prev[commentId]\n    }));\n  };\n\n  // Add this function below handleToggleReplies\n  const handleToggleDescendants = replyId => {\n    setOpenDescendants(prev => ({\n      ...prev,\n      [replyId]: !prev[replyId]\n    }));\n  };\n\n  // Helper: Render reply text with styled @username if present\n  function renderReplyText(text) {\n    if (typeof text !== 'string') return '';\n    const match = text.match(/^@(\\S+)\\s(.*)$/);\n    if (match) {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: '#1e90ff',\n            fontWeight: 500\n          },\n          children: `@${match[1]}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 11\n        }, this), ' ', match[2]]\n      }, void 0, true);\n    }\n    return text;\n  }\n  if (!open) return null;\n  function handleOverlayClick(e) {\n    if (drawerRef.current && !drawerRef.current.contains(e.target)) {\n      onClose();\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: overlayStyle,\n    onMouseDown: handleOverlayClick,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: drawerRef ? drawerStyle : {},\n      ref: drawerRef,\n      onMouseDown: e => e.stopPropagation(),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: headerStyle,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: [trackTitle, \" \\u2014 \", artist === null || artist === void 0 ? void 0 : artist.name, \" (\", artist === null || artist === void 0 ? void 0 : artist.numTracks, \" \", (artist === null || artist === void 0 ? void 0 : artist.numTracks) === 1 ? 'track' : 'tracks', \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          style: closeBtnStyle,\n          \"aria-label\": \"Close\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: commentsListStyle,\n        children: [loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: '#aaa'\n          },\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 22\n        }, this) : null, !loading && comments.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: '#aaa'\n          },\n          children: \"No comments yet. Be the first to comment!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 13\n        }, this) : comments.map(c => {\n          var _c$user, _c$content, _c$replies;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '1.2rem',\n              borderBottom: '1px solid #222',\n              paddingBottom: '0.7rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              style: {\n                color: '#1db954'\n              },\n              children: ((_c$user = c.user) === null || _c$user === void 0 ? void 0 : _c$user.name) || 'User'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: '0.2rem',\n                color: '#fff'\n              },\n              children: (_c$content = c.content) !== null && _c$content !== void 0 ? _c$content : c.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                flexDirection: 'row',\n                gap: '1.2rem',\n                marginTop: '0.3rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                style: {\n                  background: 'none',\n                  color: '#1e90ff',\n                  border: 'none',\n                  cursor: 'pointer',\n                  fontSize: '0.95em'\n                },\n                onClick: () => {\n                  var _c$user2;\n                  return handleReplyToComment(c._id, ((_c$user2 = c.user) === null || _c$user2 === void 0 ? void 0 : _c$user2.name) || 'User');\n                },\n                children: \"Reply\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 19\n              }, this), ((_c$replies = c.replies) === null || _c$replies === void 0 ? void 0 : _c$replies.length) > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n                style: {\n                  background: 'none',\n                  color: '#1e90ff',\n                  border: 'none',\n                  cursor: 'pointer',\n                  fontSize: '0.95em'\n                },\n                onClick: () => handleToggleReplies(c._id),\n                children: openReplies[c._id] ? 'Hide Replies' : 'View Replies'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 17\n            }, this), activeReplyInputId === c._id && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginLeft: '1.2rem',\n                marginTop: '0.5rem'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                ref: el => replyInputRefs.current[c._id] = el,\n                style: replyInputStyle,\n                placeholder: \"Write a reply...\",\n                value: replyInputs[c._id] || '',\n                onChange: e => setReplyInputs(i => ({\n                  ...i,\n                  [c._id]: e.target.value\n                }))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                style: {\n                  background: '#1db954',\n                  color: 'white',\n                  border: 'none',\n                  borderRadius: '6px',\n                  padding: '0.3rem 1rem',\n                  cursor: 'pointer',\n                  marginTop: '0.2rem'\n                },\n                onClick: () => handleAddReply(c._id),\n                disabled: replying[c._id],\n                children: replying[c._id] ? 'Replying...' : 'Reply'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 19\n            }, this), openReplies[c._id] && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginLeft: '1.2rem',\n                marginTop: '0.5rem'\n              },\n              children: (c.replies || []).map(reply => {\n                var _reply$user, _reply$content;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginBottom: '0.7rem'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                    style: {\n                      color: '#1db954'\n                    },\n                    children: ((_reply$user = reply.user) === null || _reply$user === void 0 ? void 0 : _reply$user.name) || 'User'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 288,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      color: '#fff'\n                    },\n                    children: renderReplyText((_reply$content = reply.content) !== null && _reply$content !== void 0 ? _reply$content : reply.text)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 289,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    style: {\n                      background: 'none',\n                      color: '#1e90ff',\n                      border: 'none',\n                      cursor: 'pointer',\n                      fontSize: '0.92em',\n                      marginLeft: '0.5rem'\n                    },\n                    onClick: () => {\n                      var _reply$user2;\n                      return handleReplyToReply(c._id, reply._id, ((_reply$user2 = reply.user) === null || _reply$user2 === void 0 ? void 0 : _reply$user2.name) || 'User');\n                    },\n                    children: \"Reply\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 290,\n                    columnNumber: 25\n                  }, this), reply.descendants && reply.descendants.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n                    style: {\n                      background: 'none',\n                      color: '#1e90ff',\n                      border: 'none',\n                      cursor: 'pointer',\n                      fontSize: '0.92em',\n                      marginLeft: '0.5rem'\n                    },\n                    onClick: () => handleToggleDescendants(reply._id),\n                    children: openDescendants[reply._id] ? 'Hide Replies' : 'View Replies'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 298,\n                    columnNumber: 27\n                  }, this), activeReplyInputId === reply._id && /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginLeft: '1.2rem',\n                      marginTop: '0.5rem'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                      ref: el => replyInputRefs.current[reply._id] = el,\n                      style: replyInputStyle,\n                      placeholder: \"Write a reply...\",\n                      value: replyInputs[reply._id] || '',\n                      onChange: e => setReplyInputs(i => ({\n                        ...i,\n                        [reply._id]: e.target.value\n                      }))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 307,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      style: {\n                        background: '#1db954',\n                        color: 'white',\n                        border: 'none',\n                        borderRadius: '6px',\n                        padding: '0.3rem 1rem',\n                        cursor: 'pointer',\n                        marginTop: '0.2rem'\n                      },\n                      onClick: () => handleAddReply(reply._id),\n                      disabled: replying[reply._id],\n                      children: replying[reply._id] ? 'Replying...' : 'Reply'\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 314,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 306,\n                    columnNumber: 27\n                  }, this), openDescendants[reply._id] && (reply.descendants || []).map(descendant => {\n                    var _descendant$user, _descendant$content;\n                    return /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        marginLeft: '1.2rem',\n                        marginTop: '0.5rem',\n                        marginBottom: '0.7rem',\n                        background: 'rgba(30,200,30,0.08)',\n                        borderRadius: '4px',\n                        padding: '0.3rem 0.5rem'\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n                        style: {\n                          color: '#1db954'\n                        },\n                        children: ((_descendant$user = descendant.user) === null || _descendant$user === void 0 ? void 0 : _descendant$user.name) || 'User'\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 326,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          color: '#fff'\n                        },\n                        children: renderReplyText((_descendant$content = descendant.content) !== null && _descendant$content !== void 0 ? _descendant$content : descendant.text)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 327,\n                        columnNumber: 29\n                      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                        style: {\n                          background: 'none',\n                          color: '#1e90ff',\n                          border: 'none',\n                          cursor: 'pointer',\n                          fontSize: '0.92em',\n                          marginLeft: '0.5rem'\n                        },\n                        onClick: () => {\n                          var _descendant$user2;\n                          return handleReplyToReply(reply._id, descendant._id, ((_descendant$user2 = descendant.user) === null || _descendant$user2 === void 0 ? void 0 : _descendant$user2.name) || 'User');\n                        },\n                        children: \"Reply\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 328,\n                        columnNumber: 29\n                      }, this), activeReplyInputId === descendant._id && /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          marginLeft: '1.2rem',\n                          marginTop: '0.5rem'\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                          ref: el => replyInputRefs.current[descendant._id] = el,\n                          style: replyInputStyle,\n                          placeholder: \"Write a reply...\",\n                          value: replyInputs[descendant._id] || '',\n                          onChange: e => setReplyInputs(i => ({\n                            ...i,\n                            [descendant._id]: e.target.value\n                          }))\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 336,\n                          columnNumber: 33\n                        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                          style: {\n                            background: '#1db954',\n                            color: 'white',\n                            border: 'none',\n                            borderRadius: '6px',\n                            padding: '0.3rem 1rem',\n                            cursor: 'pointer',\n                            marginTop: '0.2rem'\n                          },\n                          onClick: () => handleAddReply(descendant._id),\n                          disabled: replying[descendant._id],\n                          children: replying[descendant._id] ? 'Replying...' : 'Reply'\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 343,\n                          columnNumber: 33\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 335,\n                        columnNumber: 31\n                      }, this)]\n                    }, descendant._id, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 325,\n                      columnNumber: 27\n                    }, this);\n                  })]\n                }, reply._id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 23\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 19\n            }, this)]\n          }, c._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 15\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: inputSectionStyle,\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          placeholder: \"Write your comment...\",\n          style: {\n            width: '100%',\n            minHeight: '60px',\n            borderRadius: '6px',\n            padding: '0.5rem',\n            border: '1px solid #444',\n            background: '#181818',\n            color: 'white',\n            resize: 'vertical'\n          },\n          value: newComment,\n          onChange: e => setNewComment(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          style: {\n            background: '#1db954',\n            color: 'white',\n            border: 'none',\n            borderRadius: '6px',\n            padding: '0.5rem 1.2rem',\n            cursor: 'pointer',\n            alignSelf: 'flex-end'\n          },\n          onClick: handleAddComment,\n          disabled: loading,\n          children: loading ? 'Commenting...' : 'Comment'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n        children: `\n        @keyframes slideInRight {\n          from { transform: translateX(100%); }\n          to { transform: translateX(0); }\n        }\n      `\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 232,\n    columnNumber: 5\n  }, this);\n}\n_s(CommentOverlay, \"oo+87lpy+f0YeA2k5cv4R7YHtSM=\");\n_c = CommentOverlay;\nexport default CommentOverlay;\nvar _c;\n$RefreshReg$(_c, \"CommentOverlay\");","map":{"version":3,"names":["React","useRef","useEffect","useState","axios","API_URL","jsxDEV","_jsxDEV","Fragment","_Fragment","overlayStyle","position","top","left","width","height","background","zIndex","display","justifyContent","drawerStyle","maxWidth","boxShadow","flexDirection","animation","headerStyle","alignItems","padding","borderBottom","commentsListStyle","flex","overflowY","color","inputSectionStyle","borderTop","gap","closeBtnStyle","border","fontSize","cursor","replyInputStyle","minHeight","borderRadius","marginTop","marginBottom","CommentOverlay","open","onClose","track","_s","drawerRef","comments","setComments","loading","setLoading","newComment","setNewComment","replyInputs","setReplyInputs","replying","setReplying","openReplies","setOpenReplies","showReplyInput","setShowReplyInput","replyInputRefs","activeReplyInputId","setActiveReplyInputId","artist","setArtist","trackTitle","setTrackTitle","openDescendants","setOpenDescendants","fetchComments","_id","res","get","data","handleAddComment","trim","token","localStorage","getItem","post","text","headers","Authorization","err","_err$response","_err$response$data","alert","response","message","handleAddReply","parentId","_replyInputs$parentId","replyText","r","trackId","i","_err$response2","_err$response2$data","handleReplyToComment","commentId","parentUserName","inputs","_inputs$commentId","startsWith","currentId","setTimeout","input","current","focus","val","value","setSelectionRange","length","handleReplyToReply","parentCommentId","replyId","replyUserName","_inputs$replyId","handleToggleReplies","prev","handleToggleDescendants","renderReplyText","match","children","style","fontWeight","fileName","_jsxFileName","lineNumber","columnNumber","handleOverlayClick","e","contains","target","onMouseDown","ref","stopPropagation","name","numTracks","onClick","map","c","_c$user","_c$content","_c$replies","paddingBottom","user","content","_c$user2","replies","marginLeft","el","placeholder","onChange","disabled","reply","_reply$user","_reply$content","_reply$user2","descendants","descendant","_descendant$user","_descendant$content","_descendant$user2","resize","alignSelf","_c","$RefreshReg$"],"sources":["C:/Users/maali/OneDrive/Desktop/MUSIC/frontend/src/components/CommentOverlay.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport API_URL from '../config';\n\nconst overlayStyle = {\n  position: 'fixed',\n  top: 0,\n  left: 0,\n  width: '100vw',\n  height: '100vh',\n  background: 'rgba(0,0,0,0.3)',\n  zIndex: 2000,\n  display: 'flex',\n  justifyContent: 'flex-end',\n};\n\nconst drawerStyle = {\n  width: 'min(400px, 100vw)',\n  maxWidth: '100vw',\n  height: '100vh',\n  background: '#181818',\n  boxShadow: '-2px 0 16px rgba(0,0,0,0.2)',\n  display: 'flex',\n  flexDirection: 'column',\n  position: 'relative',\n  animation: 'slideInRight 0.2s',\n};\n\nconst headerStyle = {\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'space-between',\n  padding: '1rem',\n  borderBottom: '1px solid #222',\n  background: '#222',\n};\n\nconst commentsListStyle = {\n  flex: 1,\n  overflowY: 'auto',\n  padding: '1rem',\n  color: 'white',\n};\n\nconst inputSectionStyle = {\n  borderTop: '1px solid #222',\n  padding: '1rem',\n  background: '#222',\n  display: 'flex',\n  flexDirection: 'column',\n  gap: '0.5rem',\n};\n\nconst closeBtnStyle = {\n  background: 'none',\n  border: 'none',\n  color: '#fff',\n  fontSize: '1.5rem',\n  cursor: 'pointer',\n};\n\nconst replyInputStyle = {\n  width: '100%',\n  minHeight: '40px',\n  borderRadius: '6px',\n  padding: '0.3rem',\n  border: '1px solid #444',\n  background: '#222',\n  color: 'white',\n  marginTop: '0.3rem',\n  marginBottom: '0.3rem',\n};\n\nfunction CommentOverlay({ open, onClose, track }) {\n  const drawerRef = useRef();\n  const [comments, setComments] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [newComment, setNewComment] = useState('');\n  const [replyInputs, setReplyInputs] = useState({}); // {commentId: replyText}\n  const [replying, setReplying] = useState({}); // {commentId: bool}\n  const [openReplies, setOpenReplies] = useState({}); // {commentId: true/false}\n  const [showReplyInput, setShowReplyInput] = useState({}); // {commentId: bool}\n  const replyInputRefs = useRef({});\n  const [activeReplyInputId, setActiveReplyInputId] = useState(null); // ID of comment or reply being replied to\n  const [artist, setArtist] = useState(null);\n  const [trackTitle, setTrackTitle] = useState('');\n  const [openDescendants, setOpenDescendants] = useState({}); // {replyId: true/false}\n\n  // Fetch all comments for a track as a hierarchy, and artist/track info\n  const fetchComments = async () => {\n    if (!track?._id) return;\n    setLoading(true);\n    try {\n      const res = await axios.get(`${API_URL}/comments/track/${track._id}/comments-hierarchical`);\n      setComments(res.data.comments || []);\n      setArtist(res.data.artist || null);\n      setTrackTitle(res.data.trackTitle || '');\n    } catch {\n      setComments([]);\n      setArtist(null);\n      setTrackTitle('');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!open || !track?._id) return;\n    fetchComments();\n    setOpenReplies({}); // Hide all replies by default when overlay opens or track changes\n  }, [open, track]);\n\n  // Add a new top-level comment\n  const handleAddComment = async () => {\n    if (!newComment.trim()) return;\n    setLoading(true);\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`${API_URL}/comments/track/${track._id}/add`, {\n        text: newComment.trim(),\n      }, { headers: { Authorization: `Bearer ${token}` } });\n      setNewComment('');\n      await fetchComments(); // Re-fetch all comments from backend\n    } catch (err) {\n      alert(err.response?.data?.message || 'Error adding comment');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Add a reply to a comment or reply (attach to the actual parent)\n  const handleAddReply = async (parentId) => {\n    const replyText = replyInputs[parentId]?.trim();\n    if (!replyText) return;\n    setReplying(r => ({ ...r, [parentId]: true }));\n    try {\n      const token = localStorage.getItem('token');\n      await axios.post(`${API_URL}/comments/comment/${parentId}/reply`, {\n        trackId: track._id,\n        text: replyText,\n      }, { headers: { Authorization: `Bearer ${token}` } });\n      setReplyInputs(i => ({ ...i, [parentId]: '' }));\n      setActiveReplyInputId(null); // Hide input after reply\n      await fetchComments(); // Refresh comments\n    } catch (err) {\n      alert(err.response?.data?.message || 'Error adding reply');\n    } finally {\n      setReplying(r => ({ ...r, [parentId]: false }));\n    }\n  };\n\n  // New: handle reply to a top-level comment (pre-fill @ParentUserName)\n  const handleReplyToComment = (commentId, parentUserName) => {\n    setReplyInputs(inputs => ({\n      ...inputs,\n      [commentId]: inputs[commentId]?.startsWith(`@${parentUserName} `)\n        ? inputs[commentId]\n        : `@${parentUserName} `\n    }));\n    setActiveReplyInputId(currentId => {\n      if (currentId === commentId) return null; // Toggle off if already open\n      setTimeout(() => {\n        const input = replyInputRefs.current[commentId];\n        if (input) {\n          input.focus();\n          const val = input.value;\n          input.setSelectionRange(val.length, val.length);\n        }\n      }, 0);\n      return commentId;\n    });\n  };\n\n  // New: handle reply to a reply (pre-fill @username in the parent comment's reply input)\n  const handleReplyToReply = (parentCommentId, replyId, replyUserName) => {\n    setReplyInputs(inputs => ({\n      ...inputs,\n      [replyId]: inputs[replyId]?.startsWith(`@${replyUserName} `)\n        ? inputs[replyId]\n        : `@${replyUserName} `\n    }));\n    setActiveReplyInputId(currentId => {\n      if (currentId === replyId) return null; // Toggle off if already open\n      setTimeout(() => {\n        const input = replyInputRefs.current[replyId];\n        if (input) {\n          input.focus();\n          const val = input.value;\n          input.setSelectionRange(val.length, val.length);\n        }\n      }, 0);\n      return replyId;\n    });\n  };\n\n  // Toggle replies for a comment\n  const handleToggleReplies = async (commentId) => {\n    setOpenReplies(prev => ({ ...prev, [commentId]: !prev[commentId] }));\n  };\n\n  // Add this function below handleToggleReplies\n  const handleToggleDescendants = (replyId) => {\n    setOpenDescendants(prev => ({\n      ...prev,\n      [replyId]: !prev[replyId]\n    }));\n  };\n\n  // Helper: Render reply text with styled @username if present\n  function renderReplyText(text) {\n    if (typeof text !== 'string') return '';\n    const match = text.match(/^@(\\S+)\\s(.*)$/);\n    if (match) {\n      return (\n        <>\n          <span style={{ color: '#1e90ff', fontWeight: 500 }}>{`@${match[1]}`}</span>{' '}{match[2]}\n        </>\n      );\n    }\n    return text;\n  }\n\n  if (!open) return null;\n\n  function handleOverlayClick(e) {\n    if (drawerRef.current && !drawerRef.current.contains(e.target)) {\n      onClose();\n    }\n  }\n\n  return (\n    <div style={overlayStyle} onMouseDown={handleOverlayClick}>\n      <div style={drawerRef ? drawerStyle : {}} ref={drawerRef} onMouseDown={e => e.stopPropagation()}>\n        <div style={headerStyle}>\n          <span>{trackTitle} — {artist?.name} ({artist?.numTracks} {artist?.numTracks === 1 ? 'track' : 'tracks'})</span>\n          <span></span>\n          <button onClick={onClose} style={closeBtnStyle} aria-label=\"Close\">×</button>\n        </div>\n        <div style={commentsListStyle}>\n          {loading ? <p style={{ color: '#aaa' }}>Loading...</p> : null}\n          {!loading && comments.length === 0 ? (\n            <p style={{ color: '#aaa' }}>No comments yet. Be the first to comment!</p>\n          ) : (\n            comments.map(c => (\n              <div key={c._id} style={{ marginBottom: '1.2rem', borderBottom: '1px solid #222', paddingBottom: '0.7rem' }}>\n                <b style={{ color: '#1db954' }}>{c.user?.name || 'User'}</b>\n                <div style={{ marginTop: '0.2rem', color: '#fff' }}>{c.content ?? c.text}</div>\n                <div style={{ display: 'flex', flexDirection: 'row', gap: '1.2rem', marginTop: '0.3rem' }}>\n                  <button\n                    style={{ background: 'none', color: '#1e90ff', border: 'none', cursor: 'pointer', fontSize: '0.95em' }}\n                    onClick={() => handleReplyToComment(c._id, c.user?.name || 'User')}\n                  >\n                    Reply\n                  </button>\n                  {(c.replies?.length > 0) && (\n                <button\n                      style={{ background: 'none', color: '#1e90ff', border: 'none', cursor: 'pointer', fontSize: '0.95em' }}\n                  onClick={() => handleToggleReplies(c._id)}\n                >\n                  {openReplies[c._id] ? 'Hide Replies' : 'View Replies'}\n                </button>\n                  )}\n                </div>\n                {/* Show reply input below parent comment if active */}\n                {activeReplyInputId === c._id && (\n                  <div style={{ marginLeft: '1.2rem', marginTop: '0.5rem' }}>\n                    <textarea\n                      ref={el => (replyInputRefs.current[c._id] = el)}\n                      style={replyInputStyle}\n                      placeholder=\"Write a reply...\"\n                      value={replyInputs[c._id] || ''}\n                      onChange={e => setReplyInputs(i => ({ ...i, [c._id]: e.target.value }))}\n                    />\n                    <button\n                      style={{ background: '#1db954', color: 'white', border: 'none', borderRadius: '6px', padding: '0.3rem 1rem', cursor: 'pointer', marginTop: '0.2rem' }}\n                      onClick={() => handleAddReply(c._id)}\n                      disabled={replying[c._id]}\n                    >\n                      {replying[c._id] ? 'Replying...' : 'Reply'}\n                    </button>\n                  </div>\n                )}\n                {/* Replies: only two levels of indentation, all descendants flat under each direct reply */}\n                {openReplies[c._id] && (\n                  <div style={{ marginLeft: '1.2rem', marginTop: '0.5rem' }}>\n                    {(c.replies || []).map(reply => (\n                      <div key={reply._id} style={{ marginBottom: '0.7rem' }}>\n                        <b style={{ color: '#1db954' }}>{reply.user?.name || 'User'}</b>\n                        <div style={{ color: '#fff' }}>{renderReplyText(reply.content ?? reply.text)}</div>\n                        <button\n                          style={{ background: 'none', color: '#1e90ff', border: 'none', cursor: 'pointer', fontSize: '0.92em', marginLeft: '0.5rem' }}\n                          onClick={() => handleReplyToReply(c._id, reply._id, reply.user?.name || 'User')}\n                        >\n                          Reply\n                        </button>\n                        {/* Toggle descendants button */}\n                        {(reply.descendants && reply.descendants.length > 0) && (\n                          <button\n                            style={{ background: 'none', color: '#1e90ff', border: 'none', cursor: 'pointer', fontSize: '0.92em', marginLeft: '0.5rem' }}\n                            onClick={() => handleToggleDescendants(reply._id)}\n                          >\n                            {openDescendants[reply._id] ? 'Hide Replies' : 'View Replies'}\n                          </button>\n                        )}\n                        {activeReplyInputId === reply._id && (\n                          <div style={{ marginLeft: '1.2rem', marginTop: '0.5rem' }}>\n                            <textarea\n                              ref={el => (replyInputRefs.current[reply._id] = el)}\n                              style={replyInputStyle}\n                              placeholder=\"Write a reply...\"\n                              value={replyInputs[reply._id] || ''}\n                              onChange={e => setReplyInputs(i => ({ ...i, [reply._id]: e.target.value }))}\n                            />\n                            <button\n                              style={{ background: '#1db954', color: 'white', border: 'none', borderRadius: '6px', padding: '0.3rem 1rem', cursor: 'pointer', marginTop: '0.2rem' }}\n                              onClick={() => handleAddReply(reply._id)}\n                              disabled={replying[reply._id]}\n                            >\n                              {replying[reply._id] ? 'Replying...' : 'Reply'}\n                            </button>\n                          </div>\n                        )}\n                        {/* Render all descendants of this reply (flat, no further nesting) with toggle */}\n                        {openDescendants[reply._id] && (reply.descendants || []).map(descendant => (\n                          <div key={descendant._id} style={{ marginLeft: '1.2rem', marginTop: '0.5rem', marginBottom: '0.7rem', background: 'rgba(30,200,30,0.08)', borderRadius: '4px', padding: '0.3rem 0.5rem' }}>\n                            <b style={{ color: '#1db954' }}>{descendant.user?.name || 'User'}</b>\n                            <div style={{ color: '#fff' }}>{renderReplyText(descendant.content ?? descendant.text)}</div>\n                            <button\n                              style={{ background: 'none', color: '#1e90ff', border: 'none', cursor: 'pointer', fontSize: '0.92em', marginLeft: '0.5rem' }}\n                              onClick={() => handleReplyToReply(reply._id, descendant._id, descendant.user?.name || 'User')}\n                            >\n                              Reply\n                            </button>\n                            {activeReplyInputId === descendant._id && (\n                              <div style={{ marginLeft: '1.2rem', marginTop: '0.5rem' }}>\n                                <textarea\n                                  ref={el => (replyInputRefs.current[descendant._id] = el)}\n                                  style={replyInputStyle}\n                                  placeholder=\"Write a reply...\"\n                                  value={replyInputs[descendant._id] || ''}\n                                  onChange={e => setReplyInputs(i => ({ ...i, [descendant._id]: e.target.value }))}\n                                />\n                                <button\n                                  style={{ background: '#1db954', color: 'white', border: 'none', borderRadius: '6px', padding: '0.3rem 1rem', cursor: 'pointer', marginTop: '0.2rem' }}\n                                  onClick={() => handleAddReply(descendant._id)}\n                                  disabled={replying[descendant._id]}\n                                >\n                                  {replying[descendant._id] ? 'Replying...' : 'Reply'}\n                                </button>\n                              </div>\n                            )}\n                          </div>\n                        ))}\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            ))\n          )}\n        </div>\n        <div style={inputSectionStyle}>\n          <textarea\n            placeholder=\"Write your comment...\"\n            style={{ width: '100%', minHeight: '60px', borderRadius: '6px', padding: '0.5rem', border: '1px solid #444', background: '#181818', color: 'white', resize: 'vertical' }}\n            value={newComment}\n            onChange={e => setNewComment(e.target.value)}\n          />\n          <button\n            style={{ background: '#1db954', color: 'white', border: 'none', borderRadius: '6px', padding: '0.5rem 1.2rem', cursor: 'pointer', alignSelf: 'flex-end' }}\n            onClick={handleAddComment}\n            disabled={loading}\n          >\n            {loading ? 'Commenting...' : 'Comment'}\n          </button>\n        </div>\n      <style>{`\n        @keyframes slideInRight {\n          from { transform: translateX(100%); }\n          to { transform: translateX(0); }\n        }\n      `}</style>\n      </div>\n    </div>\n  );\n}\n\nexport default CommentOverlay; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}